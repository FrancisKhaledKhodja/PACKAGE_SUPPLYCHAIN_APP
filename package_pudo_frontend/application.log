2025-11-17 18:51:26.251 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-17 18:54:14.208 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-17 18:54:15.515 | ERROR    | package_pudo_api.blueprints.pudo.routes:pudo_update_api:66 - An error has been caught in function 'pudo_update_api', process 'MainProcess' (15320), thread 'Thread-6 (process_request_thread)' (18484):
Traceback (most recent call last):

  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000227C4E70AE0>
    └ <Thread(Thread-6 (process_request_thread), started daemon 18484)>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x00000227C4E70860>
    └ <Thread(Thread-6 (process_request_thread), started daemon 18484)>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-6 (process_request_thread), started daemon 18484)>
    │    │        │    └ (<socket.socket fd=1140, family=2, type=1, proto=0, laddr=('127.0.0.1', 5001), raddr=('127.0.0.1', 50424)>, ('127.0.0.1', 504...
    │    │        └ <Thread(Thread-6 (process_request_thread), started daemon 18484)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x00000227E72892B0>>
    └ <Thread(Thread-6 (process_request_thread), started daemon 18484)>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 697, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('127.0.0.1', 50424)
    │    │              └ <socket.socket fd=1140, family=2, type=1, proto=0, laddr=('127.0.0.1', 5001), raddr=('127.0.0.1', 50424)>
    │    └ <function BaseServer.finish_request at 0x00000227C531D120>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x00000227E72892B0>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x00000227E72892B0>
    │    │                   │        └ ('127.0.0.1', 50424)
    │    │                   └ <socket.socket fd=1140, family=2, type=1, proto=0, laddr=('127.0.0.1', 5001), raddr=('127.0.0.1', 50424)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x00000227E72892B0>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 766, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x00000227C7240C20>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x00000227E72BC510>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\werkzeug\serving.py", line 398, in handle
    super().handle()
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x00000227C53EBC40>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x00000227E72BC510>
  File "C:\Users\Khaled-Khodja\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x00000227E72BC510>>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\werkzeug\serving.py", line 370, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'package_pudo_api'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x00000227E72892B0>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x00000227E72BC510>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x00000227E72CD3A0>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\werkzeug\serving.py", line 331, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x00000227E72CD4E0>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=1140>, 'wsgi.errors': <_io.TextIOW...
                       └ <Flask 'package_pudo_api'>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\flask\app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x00000227E72CD4E0>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=1140>, 'wsgi.errors': <_io.TextIOW...
           │    └ <function Flask.wsgi_app at 0x00000227C7EDE480>
           └ <Flask 'package_pudo_api'>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x00000227C7EDDBC0>
               └ <Flask 'package_pudo_api'>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x00000227C7EDDB20>
         └ <Flask 'package_pudo_api'>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           │    │           │    │              │    │            └ {}
           │    │           │    │              │    └ 'pudo.pudo_update_api'
           │    │           │    │              └ <Rule '/api/pudo/update' (POST, OPTIONS) -> pudo.pudo_update_api>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x00000227D6C9EFC0>, 'auth.login': <function login at 0x00000227C7EF...
           │    │           └ <Flask 'package_pudo_api'>
           │    └ <function Flask.ensure_sync at 0x00000227C7EDDDA0>
           └ <Flask 'package_pudo_api'>

> File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\package_pudo_api\blueprints\pudo\routes.py", line 66, in pudo_update_api
    result = update_data()
             └ <function update_data at 0x00000227C857B060>

  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\package_pudo_api\data\pudo_etl.py", line 193, in update_data
    stock_554_df = pl.read_excel(stock_554_info["src"])
                   │  │          └ {'key': 'stock_554', 'src': '\\\\apps\\Vol1\\Data\\011-BO_XI_entrees\\07-DOR_DP\\Sorties\\554 - (STK SPD TPS REEL) - STOCK TE...
                   │  └ <function read_excel at 0x00000227C83628E0>
                   └ <module 'polars' from 'C:\\Users\\Khaled-Khodja\\OneDrive - TDF SAS\\SCRIPTS_PYTHON\\PACKAGE_SUPPLYCHAIN_APP\\.venv\\Lib\\sit...

  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\polars\_utils\deprecation.py", line 128, in wrapper
    return function(*args, **kwargs)
           │         │       └ {}
           │         └ ('\\\\apps\\Vol1\\Data\\011-BO_XI_entrees\\07-DOR_DP\\Sorties\\554 - (STK SPD TPS REEL) - STOCK TEMPS REEL SUPPLYCHAIN_APP.xl...
           └ <function read_excel at 0x00000227C8362A20>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\polars\_utils\deprecation.py", line 128, in wrapper
    return function(*args, **kwargs)
           │         │       └ {}
           │         └ ('\\\\apps\\Vol1\\Data\\011-BO_XI_entrees\\07-DOR_DP\\Sorties\\554 - (STK SPD TPS REEL) - STOCK TEMPS REEL SUPPLYCHAIN_APP.xl...
           └ <function read_excel at 0x00000227C8362980>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\polars\io\spreadsheet\functions.py", line 403, in read_excel
    _read_spreadsheet(
    └ <function _read_spreadsheet at 0x00000227C8362F20>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\polars\io\spreadsheet\functions.py", line 684, in _read_spreadsheet
    name: reader_fn(
          └ <function _read_spreadsheet_calamine at 0x00000227C8363420>
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\polars\io\spreadsheet\functions.py", line 1081, in _read_spreadsheet_calamine
    ws_arrow = parser.load_sheet_eager(sheet_name, **read_options)
               │      │                │             └ {'schema_sample_rows': 100}
               │      │                └ 'stock'
               │      └ <function ExcelReader.load_sheet_eager at 0x00000227E72CF740>
               └ ExcelReader<\\apps\Vol1\Data\011-BO_XI_entrees\07-DOR_DP\Sorties\554 - (STK SPD TPS REEL) - STOCK TEMPS REEL SUPPLYCHAIN_APP....
  File "C:\Users\Khaled-Khodja\OneDrive - TDF SAS\SCRIPTS_PYTHON\PACKAGE_SUPPLYCHAIN_APP\.venv\Lib\site-packages\fastexcel\__init__.py", line 576, in load_sheet_eager
    return self._reader.load_sheet(
           │    │       └ <method 'load_sheet' of 'builtins._ExcelReader' objects>
           │    └ ExcelReader<\\apps\Vol1\Data\011-BO_XI_entrees\07-DOR_DP\Sorties\554 - (STK SPD TPS REEL) - STOCK TEMPS REEL SUPPLYCHAIN_APP....
           └ ExcelReader<\\apps\Vol1\Data\011-BO_XI_entrees\07-DOR_DP\Sorties\554 - (STK SPD TPS REEL) - STOCK TEMPS REEL SUPPLYCHAIN_APP....

ModuleNotFoundError: No module named 'pyarrow'
2025-11-17 18:56:35.964 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-17 18:56:37.665 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-17 19:03:08.764 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-17 19:03:10.584 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-18 04:59:01.949 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 04:59:03.921 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-18 05:18:21.440 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 05:18:30.712 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-18 06:29:17.341 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 06:29:18.819 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-18 06:33:34.723 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 06:33:36.677 | INFO     | package_pudo_api.data.pudo_etl:update_data:199 - Data updated successfully
2025-11-18 07:10:30.173 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 07:10:32.371 | INFO     | package_pudo_api.data.pudo_etl:update_data:215 - Data updated successfully
2025-11-18 08:27:54.110 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 08:28:03.164 | INFO     | package_pudo_api.data.pudo_etl:update_data:215 - Data updated successfully
2025-11-18 11:31:18.650 | INFO     | package_pudo_api.data.pudo_etl:update_data:144 - Update data
2025-11-18 11:31:21.079 | INFO     | package_pudo_api.data.pudo_etl:update_data:217 - Data updated successfully
2025-11-18 17:47:10.506 | INFO     | package_pudo_api.data.pudo_etl:update_data:154 - Update data
2025-11-18 17:47:14.451 | INFO     | package_pudo_api.data.pudo_etl:update_data:232 - Data updated successfully
2025-11-18 18:10:49.661 | INFO     | package_pudo_api.data.pudo_etl:update_data:157 - Update data
2025-11-18 18:10:53.934 | INFO     | package_pudo_api.data.pudo_etl:update_data:236 - Data updated successfully
