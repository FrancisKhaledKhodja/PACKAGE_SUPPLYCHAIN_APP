<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>LOCALISATION DU STOCK PAR ARTICLE</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/stock_map.css">
  <script src="js/api.js?v=2" defer></script>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
    defer
  ></script>
  <script src="js/stock_map.js?v=2" defer></script>
</head>
<body>
  <div id="scapp-header"></div>

  <div class="layout stock-map-layout">
    <aside class="card">
      <h2 class="stock-map-title">Localisation du stock par article</h2>
      <form id="form-stock-map" class="section stock-map-form" onsubmit="return false;">
        <div class="stock-map-field">
          <label class="muted" for="code_article">Code article (un ou plusieurs, séparés par des ";")</label>
          <input type="text" id="code_article" placeholder="Ex : TDF158545;TDF158548" />
        </div>

        <div class="section stock-map-subsection">
          <div class="muted stock-map-subsection-note">
            Optionnel : renseigner un <strong>code IG</strong> ou une <strong>adresse postale</strong> pour positionner le centre de la carte
            et calculer la distance à vol d'oiseau entre chaque magasin et ce point.
          </div>

          <div class="stock-map-field stock-map-field--tight">
            <label class="muted" for="code_ig">Code IG</label>
            <input type="text" id="code_ig" placeholder="Ex : FR12345" />
          </div>

          <div class="stock-map-field stock-map-field--tight">
            <label class="muted" for="address">Adresse postale</label>
            <input type="text" id="address" placeholder="Ex : 100 rue ..., 75000 Paris" />
          </div>

          <div class="section stock-map-filters">
            <div class="muted stock-map-filters-header">
              <span>Filtres stock</span>
              <label class="stock-map-toggle-label">
                <input type="checkbox" id="stock-filters-toggle" checked /> Tout cocher / décocher
              </label>
            </div>

            <div class="stock-map-filter-block">
              <div class="muted stock-map-filter-title">Type de dépôt</div>
              <div class="stock-map-filter-grid">
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="NATIONAL" checked> NATIONAL</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="LOCAL" checked> LOCAL</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="REO" checked> REO</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="PIED DE SITE" checked> PIED DE SITE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="EMBARQUE"> EMBARQUE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="LABORATOIRE"> LABORATOIRE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="DIVERS"> DIVERS</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="END"> END</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="FOURNISSEURS"> FOURNISSEURS</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="SOUS TRAITANTS"> SOUS TRAITANTS</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="DTOM"> DTOM</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="EXPERT DTE"> EXPERT DTE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="EXPERT DPR"> EXPERT DPR</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="REPARATEUR INTERNE"> REPARATEUR INTERNE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="REPARATEUR EXTERNE"> REPARATEUR EXTERNE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="RESERVE"> RESERVE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="FILIALE"> FILIALE</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="type_de_depot" value="DATACENTER"> DATACENTER</label>
              </div>
            </div>

            <div class="stock-map-filter-block">
              <div class="muted stock-map-filter-title">Code qualité</div>
              <div class="stock-map-filter-grid">
                <label class="stock-map-filter-item"><input type="checkbox" name="code_qualite" value="GOOD" checked> GOOD</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="code_qualite" value="BLOQG"> BLOQG</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="code_qualite" value="BAD"> BAD</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="code_qualite" value="BLOQB"> BLOQB</label>
              </div>
            </div>

            <div>
              <div class="muted stock-map-filter-title">Type de stock (flag_stock_d_m)</div>
              <div class="stock-map-filter-grid">
                <label class="stock-map-filter-item"><input type="checkbox" name="flag_stock_d_m" value="M" checked> M</label>
                <label class="stock-map-filter-item"><input type="checkbox" name="flag_stock_d_m" value="D"> D</label>
              </div>
            </div>

            <div class="stock-map-filter-block">
              <div class="muted stock-map-filter-title">Autres filtres</div>
              <div class="stock-map-filter-grid">
                <label class="stock-map-filter-item stock-map-filter-item--full"><input type="checkbox" id="hors_transit" checked> HORS TRANSIT (exclure les emplacements se terminant par -T)</label>
              </div>
            </div>
          </div>
        </div>

        <button id="btn-search-stock-map" type="submit" class="stock-map-search-btn">Afficher sur la carte</button>
        <div id="stock-map-status" class="muted"></div>
      </form>
      <div class="section">
        <div id="stock-map-article-info" class="muted stock-map-article-info"></div>
        <div id="stock-map-center-info" class="muted stock-map-center-info"></div>
      </div>
    </aside>

    <main class="card">
      <div class="card stock-map-hero-card">
        <h3 class="stock-map-hero-title">Carte des magasins avec stock</h3>
        <div id="stock-map" class="scapp-map"></div>
        <div class="stock-map-legend">
          <span class="stock-map-legend-label">Légende type de dépôt :</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--national"></span> NATIONAL</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--local"></span> LOCAL</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--reo"></span> REO</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--pied"></span> PIED DE SITE</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--embarque"></span> EMBARQUE</span>
          <span class="stock-map-legend-item"><span class="stock-map-legend-dot stock-map-legend-dot--autres"></span> AUTRES</span>
        </div>
      </div>

      <div class="card">
        <div class="row stock-map-toolbar">
          <div>
            <div id="stock-map-count" class="muted"></div>
          </div>
          <div>
            <button id="btn-export-stock-map" type="button">Exporter en Excel</button>
          </div>
        </div>
        <div class="scapp-overflow-auto scapp-maxh-35vh">
          <table id="tbl-stock-map">
            <thead><tr id="stock-map-thead-row"></tr></thead>
            <tbody id="stock-map-tbody-rows"></tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
</body>
</html>
